# 装甲车辆抗毁伤数字化评估软件平台 - 运行说明

## 🎯 快速启动指南

### 主程序文件
**文件名**: `ArmorVehicleDamageAssessment.UI.exe`
**位置**: 发布目录中
**运行方式**: 双击即可启动图形化界面

## 📦 发布版本说明

### 自包含版本 (推荐)
- **路径**: `publish/win-x64-self-contained/`
- **优点**: 无需安装.NET运行时，可在任何Windows 10/11机器上运行
- **文件大小**: 较大(约100-200MB)
- **适用场景**: 部署到没有.NET环境的机器

### 框架依赖版本
- **路径**: `publish/win-x64-framework-dependent/`
- **优点**: 文件体积小
- **前提**: 需要预装.NET 8.0运行时
- **适用场景**: 开发环境或已安装.NET的机器

## 🖥️ 系统界面介绍

### 启动界面
程序启动后将显示：
- **窗口标题**: "装甲车辆抗毁伤数字化评估软件平台"
- **窗口大小**: 1200×800像素，可调整
- **主题风格**: Material Design 深色主题

### 主要功能区域

#### 1. 顶部标题栏
- 应用程序图标和名称
- 版本信息：沈阳理工大学 • 版本 1.0.0
- 设置和帮助按钮

#### 2. 左侧导航栏 (250px宽)
**功能模块**:
- 📁 算例管理 (默认选中)
- 🎯 动能穿甲仿真
- ⚡ 聚能破甲仿真
- 💥 爆炸冲击仿真

**数据库管理**:
- 🗄️ 材料库管理
- 🚛 车辆模型库
- 🎯 制式弹模型库

#### 3. 右侧主内容区域
- 默认显示算例管理界面
- 包含数据表格、操作按钮等

#### 4. 底部状态栏
- 显示当前系统状态
- 版权信息

## 🚀 运行发布文件详细指南

### 方式一：运行压缩包版本 (推荐)

#### 步骤1: 获取发布文件
从发布目录获取：`publish/ArmorVehicleDamageAssessment-Windows-v1.0.0.zip`

#### 步骤2: 解压到目标目录
```
✅ 右键点击压缩包 → 解压到文件夹
✅ 选择目标位置，如：D:\ArmorVehicleAssessment\
✅ 解压后文件结构：
   D:\ArmorVehicleAssessment\
   ├── ArmorVehicleDamageAssessment.UI.exe    👈 主程序
   ├── appsettings.json
   ├── NLog.config
   ├── *.dll 文件
   └── 其他依赖文件
```

#### 步骤3: 直接运行
```
🖱️ 双击 ArmorVehicleDamageAssessment.UI.exe
⚡ 程序启动，显示图形界面
```

### 方式二：运行发布目录版本

#### 步骤1: 导航到发布目录
```
📁 打开文件资源管理器
📍 导航到：你的项目路径\publish\win-x64-self-contained\
   或：你的项目路径\publish\win-x64-framework-dependent\
```

#### 步骤2: 找到主程序
```
🔍 在目录中找到：ArmorVehicleDamageAssessment.UI.exe
📋 文件图标应显示为应用程序类型
```

#### 步骤3: 启动程序
```
🖱️ 双击 ArmorVehicleDamageAssessment.UI.exe
⚡ 或者右键 → 打开
```

### 方式三：使用便捷启动脚本 (推荐)

我们提供了两个启动脚本，可以自动检测和运行程序：

#### Windows批处理脚本
```cmd
# 导航到项目scripts目录
cd "你的项目路径\scripts"

# 双击运行脚本
run-app.bat

# 或命令行运行
.\run-app.bat
```

#### PowerShell脚本 (功能更强)
```powershell
# 导航到项目scripts目录
cd "你的项目路径\scripts"

# 自动检测运行最佳版本
.\run-app.ps1

# 强制运行自包含版本
.\run-app.ps1 -SelfContained

# 强制运行框架依赖版本
.\run-app.ps1 -FrameworkDependent

# 查看帮助
.\run-app.ps1 -Help
```

**脚本优势**:
- ✅ 自动检测可用版本
- ✅ 智能选择最佳运行方式
- ✅ 提供详细的错误信息和解决建议
- ✅ 检查系统环境和依赖
- ✅ 中文界面友好提示

### 方式四：命令行手动运行 (高级用户)

#### 打开命令提示符
```cmd
# 导航到发布目录
cd "D:\ArmorVehicleAssessment"

# 直接运行
ArmorVehicleDamageAssessment.UI.exe

# 或者使用完整路径
"D:\ArmorVehicleAssessment\ArmorVehicleDamageAssessment.UI.exe"
```

#### PowerShell运行
```powershell
# 导航到发布目录
Set-Location "D:\ArmorVehicleAssessment"

# 运行程序
.\ArmorVehicleDamageAssessment.UI.exe
```

## 🔍 运行前检查清单

### 必需文件检查
确保以下核心文件存在：
- ✅ `ArmorVehicleDamageAssessment.UI.exe` (主程序 - 约5-10MB)
- ✅ `ArmorVehicleDamageAssessment.Core.dll` (核心库)
- ✅ `ArmorVehicleDamageAssessment.Data.dll` (数据库层)
- ✅ `ArmorVehicleDamageAssessment.Common.dll` (通用组件)
- ✅ `appsettings.json` (配置文件)
- ✅ `NLog.config` (日志配置)
- ✅ `MaterialDesignThemes.Wpf.dll` (UI主题库)
- ✅ `Microsoft.EntityFrameworkCore.*.dll` (数据库ORM)

### 系统环境检查
- ✅ Windows 10/11 x64 操作系统
- ✅ 可用内存 > 4GB
- ✅ 可用磁盘空间 > 500MB
- ✅ .NET 8.0 运行时 (框架依赖版本需要)

## 🎯 首次启动验证

### 启动成功标志
程序正常启动后应该看到：

1. **窗口标题**: "装甲车辆抗毁伤数字化评估软件平台"
2. **窗口大小**: 1200×800像素 (可调整)
3. **界面布局**: 
   - 顶部蓝色标题栏
   - 左侧功能导航栏
   - 右侧主内容区域
   - 底部状态栏

### 功能验证步骤
```
✅ 步骤1: 界面完整显示，无错误弹窗
✅ 步骤2: 点击左侧"算例管理"，右侧加载数据表格
✅ 步骤3: 尝试点击其他导航项，确认页面切换正常
✅ 步骤4: 检查底部状态栏显示"就绪"状态
```

## 🚨 运行失败解决方案

### 情况1: 双击无反应
**诊断步骤**:
```
🔍 检查Windows事件查看器:
   控制面板 → 管理工具 → 事件查看器 → Windows日志 → 应用程序
   
🔍 查看是否有相关错误记录
```

**解决方法**:
```
1️⃣ 安装.NET 8.0运行时 (框架依赖版本)
2️⃣ 以管理员身份运行
3️⃣ 检查杀毒软件是否拦截
4️⃣ 重新解压发布包
```

### 情况2: 程序启动后立即关闭
**查看日志**:
```
📁 检查程序目录下的 logs/ 文件夹
📄 打开最新的日志文件 (格式: 2025-01-27.log)
🔍 查看错误信息
```

**常见问题**:
```
❌ 配置文件格式错误 → 检查 appsettings.json 语法
❌ 缺少依赖库 → 重新解压完整的发布包
❌ 权限问题 → 以管理员身份运行
❌ 数据库权限 → 确保程序目录有写入权限
```

### 情况3: 界面显示异常
**检查DPI设置**:
```
🖱️ 右键点击 ArmorVehicleDamageAssessment.UI.exe
⚙️ 属性 → 兼容性选项卡
🔧 点击"更改高DPI设置"
✅ 勾选"替代高DPI缩放行为"
📐 选择"系统(增强)"
```

## 📋 运行环境配置

### 推荐的文件夹结构
```
建议的安装位置:
C:\Program Files\ArmorVehicleAssessment\     (系统级安装)
或
D:\Software\ArmorVehicleAssessment\          (用户级安装)

避免的位置:
- 包含中文字符的路径
- 临时文件夹
- 系统保护目录
```

### 权限设置
```
🔒 如果安装在Program Files目录:
   需要管理员权限首次运行
   
🔓 如果安装在用户目录:
   普通用户权限即可运行
```

## 🔧 常见问题排查

### 问题1: 双击exe无反应
**可能原因**:
- 缺少.NET运行时 (框架依赖版本)
- 被杀毒软件拦截
- 文件损坏

**解决方法**:
1. 检查Windows事件查看器中的错误信息
2. 临时关闭杀毒软件重试
3. 下载安装.NET 8.0运行时
4. 重新下载发布包

### 问题2: 程序启动后闪退
**检查项目**:
1. 查看日志文件 (`logs/` 目录)
2. 确认配置文件格式正确
3. 检查数据库文件权限

### 问题3: 界面显示异常
**可能原因**:
- 系统DPI设置过高
- 显卡驱动问题
- 缺少字体文件

**解决方法**:
1. 右键exe → 属性 → 兼容性 → 更改高DPI设置
2. 更新显卡驱动
3. 确保系统安装了"Microsoft YaHei UI"字体

## 📁 文件结构说明

```
发布目录/
├── ArmorVehicleDamageAssessment.UI.exe    # 👈 主程序 (双击运行)
├── appsettings.json                       # 应用配置
├── NLog.config                           # 日志配置
├── logs/                                 # 运行日志目录
├── data/                                 # 数据库文件目录 (自动创建)
├── ArmorVehicleDamageAssessment.*.dll    # 应用程序组件
├── Microsoft.*.dll                       # .NET依赖库
├── MaterialDesignThemes.*.dll            # UI主题库
└── 其他依赖文件
```

## 🛠️ 技术规格

### 系统要求
- **操作系统**: Windows 10 版本 1809 或更高版本
- **架构**: x64 (64位)
- **内存**: 最少 4GB RAM
- **硬盘**: 500MB 可用空间
- **显卡**: 支持 DirectX 11 的显卡

### .NET要求 (框架依赖版本)
- **.NET版本**: .NET 8.0
- **下载地址**: https://dotnet.microsoft.com/download/dotnet/8.0

### 开发环境规格
- **框架**: .NET 8.0 + WPF
- **UI库**: Material Design In XAML Toolkit
- **数据库**: SQLite 3.x + Entity Framework Core
- **日志**: NLog

## 📋 使用流程

### 典型工作流程
1. **启动程序** → 双击 `ArmorVehicleDamageAssessment.UI.exe`
2. **选择功能** → 点击左侧导航栏中的功能模块
3. **管理算例** → 在算例管理中创建、编辑仿真算例
4. **执行仿真** → 选择相应的仿真模块进行计算
5. **查看结果** → 在结果界面查看和导出仿真数据

### 数据管理
- 数据自动保存到SQLite数据库
- 支持数据导入/导出功能
- 定期备份重要数据

## 🔍 日志和调试

### 日志文件位置
- 路径: `logs/` 目录
- 格式: `yyyy-MM-dd.log`
- 内容: 包含错误信息、用户操作、系统状态等

### 查看日志
```
logs/
├── 2025-01-27.log    # 今日日志
├── 2025-01-26.log    # 昨日日志
└── ...
```

遇到问题时，请检查最新的日志文件获取错误详情。

## 📞 技术支持

### 联系方式
- **开发单位**: 沈阳理工大学
- **软件版本**: 1.0.0
- **技术支持**: 请联系项目开发团队

### 反馈信息
报告问题时请提供：
1. 错误现象描述
2. 操作步骤重现
3. 系统环境信息
4. 相关日志文件

---

*本说明文档更新于 2025年1月27日*
